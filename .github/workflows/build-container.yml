name: Build image

on:
  workflow_call:
    inputs:
      tag:
        description: 'Tag to build'
        required: true
        type: string

jobs:
  dockerize:
    name: Build container
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Download artifact
        uses: actions/download-artifact@v4
        with:
          name: build-artifact
          path: build
      - name: Build docker image
        run: |
          echo "Building tag: ghcr.io/pledger-io/amd64-pledger:${github.event.inputs.tag}"
          docker build -t ghcr.io/pledger-io/amd64-pledger:${github.event.inputs.tag} --build-arg BASE_IMAGE=eclipse-temurin:21-jre-alpine --build-arg BUILD_VERSION=${github.event.inputs.tag} .
          docker push ghcr.io/pledger-io/amd64-pledger:${github.event.inputs.tag}